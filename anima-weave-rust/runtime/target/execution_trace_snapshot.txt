[14:55:48.327] [INFO] [runtime/src/integration_test.rs:125] 🎬 === AnimaWeave 端到端测试开始 ===
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:126] 📋 测试用例: StartNode → MathNode 数据流
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:129] 🚀 启动阶段开始
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:160] 📊 X1. Graph定义完成: 2 nodes, 1 data_connections
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:166] 🏗️ X2. GraphLauncher创建完成
[14:55:48.327] [INFO] [runtime/src/launcher.rs:70] 🏗️ X1. GraphLauncher.setup() 开始
[14:55:48.327] [DEBUG] [runtime/src/launcher.rs:71]    - Graph定义: 2 nodes
[14:55:48.327] [INFO] [runtime/src/launcher.rs:74] 🎯 X2. 创建 Coordinator Actor
[14:55:48.327] [DEBUG] [runtime/src/launcher.rs:80]    ✅ Coordinator Actor 创建完成
[14:55:48.327] [INFO] [runtime/src/launcher.rs:82] 🚌 X3. 创建 DataBus Actor
[14:55:48.327] [DEBUG] [runtime/src/launcher.rs:87]    ✅ DataBus Actor 创建完成
[14:55:48.327] [INFO] [runtime/src/launcher.rs:90] 🎭 X4. 创建 NodeActors (按图定义)
[14:55:48.327] [DEBUG] [runtime/src/launcher.rs:95]    创建 NodeActor: math (type: MathNode)
[14:55:48.327] [INFO] [runtime/src/launcher.rs:107]    ✅ NodeActor 'math' 创建并注册完成
[14:55:48.327] [DEBUG] [runtime/src/launcher.rs:95]    创建 NodeActor: start (type: StartNode)
[14:55:48.327] [INFO] [runtime/src/launcher.rs:107]    ✅ NodeActor 'start' 创建并注册完成
[14:55:48.327] [INFO] [runtime/src/launcher.rs:110] 🎉 X1-X4 启动阶段完成: 所有Actor就绪
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:174] ✅ X3-X4. Actor系统启动完成 (Coordinator + DataBus + NodeActors)
[14:55:48.327] [INFO] [runtime/src/integration_test.rs:175] 🎯 启动阶段完成，进入运行阶段
[14:55:48.328] [INFO] [runtime/src/integration_test.rs:178] ⚡ A. 外部触发 - 向StartNode发送初始执行命令
[14:55:48.328] [WARN] [runtime/src/launcher.rs:171] ⚠️ 使用legacy sleep方式，建议使用 launch_and_wait_smart()
[14:55:48.328] [INFO] [runtime/src/launcher.rs:173] ⚡ A. 外部触发: 向 'start' 发送初始 NodeExecuteEvent
[14:55:48.328] [DEBUG] [runtime/src/launcher.rs:179]    生成执行ID: 943ead34-4d60-4150-b36a-7602d492a9ea
[14:55:48.328] [INFO] [runtime/src/launcher.rs:183] 📤 发送 NodeExecuteEvent 到 'start' (execution_id: 943ead34-4d60-4150-b36a-7602d492a9ea)
[14:55:48.328] [DEBUG] [runtime/src/launcher.rs:187] ⏱️ 等待事件传播... (200ms) [DEPRECATED]
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:58] 🎭 B. NodeActor 'start' 收到 NodeExecuteEvent (execution_id: 943ead34-4d60-4150-b36a-7602d492a9ea)
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:66] 📊 B1. 发送 NodeExecutionEvent(Running) → Coordinator
[14:55:48.328] [DEBUG] [core/src/actor/node_actor.rs:74]    ✅ Running状态已发送到Coordinator
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:77] ⚙️ 执行业务逻辑: start.execute()
[14:55:48.328] [INFO] [vessels/src/start_node.rs:34] 🚀 StartNode.execute() 开始 - 生成数值: 5
[14:55:48.328] [DEBUG] [vessels/src/start_node.rs:41]    创建数值输出: 5 → 'value' 端口
[14:55:48.328] [DEBUG] [vessels/src/start_node.rs:47]    创建控制信号: active → 'signal' 端口
[14:55:48.328] [INFO] [vessels/src/start_node.rs:51] ✅ StartNode 执行完成 - 输出: value=5, signal=active
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:80] ✅ 业务逻辑执行成功
[14:55:48.328] [DEBUG] [core/src/actor/node_actor.rs:81]    - data_outputs: 1 items
[14:55:48.328] [DEBUG] [core/src/actor/node_actor.rs:82]    - control_outputs: 1 items
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:85] 📦 B2. 发送 NodeOutputEvent → DataBus
[14:55:48.328] [DEBUG] [core/src/actor/node_actor.rs:94]    ✅ 输出数据已发送到DataBus
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:97] 📊 B3. 发送 NodeExecutionEvent(Completed) → Coordinator
[14:55:48.328] [DEBUG] [core/src/actor/node_actor.rs:105]    ✅ Completed状态已发送到Coordinator
[14:55:48.328] [INFO] [core/src/actor/node_actor.rs:107] 🎉 NodeActor 'start' 执行周期完成
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:263] 🎯 D2. Coordinator 收到 NodeExecutionEvent from 'start': Running
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:276]    状态: Running - 节点开始执行
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:263] 🎯 D2. Coordinator 收到 NodeExecutionEvent from 'start': Completed
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:267]    状态: Completed - 处理节点完成
[14:55:48.328] [DEBUG] [core/src/actor/coordinator/coordinator.rs:207] 🎯 D4. 调用 tracker.try_dispatch_next()
[14:55:48.328] [DEBUG] [core/src/actor/coordinator/coordinator.rs:213]    ⏸️ 调度队列暂时为空
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:264] 🚌 C1. DataBus 收到 NodeOutputEvent from 'start' (execution_id: 943ead34-4d60-4150-b36a-7602d492a9ea)
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:266]    - data_outputs: 1 items
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:267]    - control_outputs: 1 items
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:270] 💾 存储节点输出到 DataStore
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:273]    ✅ 数据已存入DataStore
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:276] 🔍 C2. 检查下游节点依赖 (基于Graph定义)
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:205]    检查 start 的下游节点: 1 个依赖者
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:209]    分析依赖节点: math
[14:55:48.328] [DEBUG] [core/src/actor/databus/actor.rs:52] (DataBus) Checking readiness for node: math
[14:55:48.328] [INFO] [core/src/actor/databus/actor.rs:70] (DataBus) Node 'math' is ready.
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:211] 🔔 C3. 节点 'math' 依赖满足，发送 NodeReadyEvent → Coordinator
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:212]    - data_inputs: 1 项
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:213]    - control_inputs: 0 项
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:229]    ✅ NodeReadyEvent 已发送
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:278]    ✅ 依赖检查完成
[14:55:48.328] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:296] 🎯 D1. Coordinator 收到 NodeReadyEvent for 'math'
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:297]    - data_inputs: 1 项
[14:55:48.328] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:298]    - control_inputs: 0 项
[14:55:48.328] [DEBUG] [core/src/actor/coordinator/coordinator.rs:170] 📋 D2. 调用 tracker.register_ready()
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:173]    ✅ 节点已注册到执行队列
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:175] 🔄 D3. 立即调用 try_dispatch_from_queue()
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:207] 🎯 D4. 调用 tracker.try_dispatch_next()
[14:55:48.329] [INFO] [core/src/actor/coordinator/coordinator.rs:209] 🚀 D5. ExecutionTracker 返回可执行的 NodeExecuteEvent for 'math'
[14:55:48.329] [INFO] [core/src/actor/coordinator/coordinator.rs:186] 🎯 D6. 从 NodeRegistry 查询 Recipient for 'math'
[14:55:48.329] [INFO] [core/src/actor/coordinator/coordinator.rs:189] 📤 D7. 发送 NodeExecuteEvent → 'math' (execution_id: evt_000005_328856503)
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:191]    ✅ Recipient 找到，开始异步发送
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:213]    ⏸️ 调度队列暂时为空
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:58] 🎭 B. NodeActor 'math' 收到 NodeExecuteEvent (execution_id: evt_000005_328856503)
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:66] 📊 B1. 发送 NodeExecutionEvent(Running) → Coordinator
[14:55:48.329] [DEBUG] [core/src/actor/node_actor.rs:74]    ✅ Running状态已发送到Coordinator
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:77] ⚙️ 执行业务逻辑: math.execute()
[14:55:48.329] [INFO] [vessels/src/math_node.rs:35] 🔢 MathNode.execute() 开始 - add_value: 3
[14:55:48.329] [DEBUG] [vessels/src/math_node.rs:36]    接收到 1 个数据输入
[14:55:48.329] [DEBUG] [vessels/src/math_node.rs:47]    输入值 'a': 5
[14:55:48.329] [DEBUG] [vessels/src/math_node.rs:48]    计算: 5 + 3 = ?
[14:55:48.329] [INFO] [vessels/src/math_node.rs:51] ✅ MathNode 计算完成: 5 + 3 = 8
[14:55:48.329] [DEBUG] [vessels/src/math_node.rs:59]    创建输出: result=8, done=active
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:80] ✅ 业务逻辑执行成功
[14:55:48.329] [DEBUG] [core/src/actor/node_actor.rs:81]    - data_outputs: 1 items
[14:55:48.329] [DEBUG] [core/src/actor/node_actor.rs:82]    - control_outputs: 1 items
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:85] 📦 B2. 发送 NodeOutputEvent → DataBus
[14:55:48.329] [DEBUG] [core/src/actor/node_actor.rs:94]    ✅ 输出数据已发送到DataBus
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:97] 📊 B3. 发送 NodeExecutionEvent(Completed) → Coordinator
[14:55:48.329] [DEBUG] [core/src/actor/node_actor.rs:105]    ✅ Completed状态已发送到Coordinator
[14:55:48.329] [INFO] [core/src/actor/node_actor.rs:107] 🎉 NodeActor 'math' 执行周期完成
[14:55:48.329] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:263] 🎯 D2. Coordinator 收到 NodeExecutionEvent from 'math': Running
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:276]    状态: Running - 节点开始执行
[14:55:48.329] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:263] 🎯 D2. Coordinator 收到 NodeExecutionEvent from 'math': Completed
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/coordinator/coordinator.rs:267]    状态: Completed - 处理节点完成
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:207] 🎯 D4. 调用 tracker.try_dispatch_next()
[14:55:48.329] [DEBUG] [core/src/actor/coordinator/coordinator.rs:213]    ⏸️ 调度队列暂时为空
[14:55:48.329] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:264] 🚌 C1. DataBus 收到 NodeOutputEvent from 'math' (execution_id: evt_000005_328856503)
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:266]    - data_outputs: 1 items
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:267]    - control_outputs: 1 items
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:270] 💾 存储节点输出到 DataStore
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:273]    ✅ 数据已存入DataStore
[14:55:48.329] [INFO] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:276] 🔍 C2. 检查下游节点依赖 (基于Graph定义)
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:205]    检查 math 的下游节点: 0 个依赖者
[14:55:48.329] [DEBUG] [/home/narcissus/Workspace/SeeleFelix/LadySion/anima-weave-rust/core/src/actor/databus/actor.rs:278]    ✅ 依赖检查完成
[14:55:48.528] [DEBUG] [runtime/src/launcher.rs:189] ⏱️ 等待完成
[14:55:48.529] [INFO] [runtime/src/integration_test.rs:181] ⏱️ 等待事件传播完成...
[14:55:49.330] [INFO] [runtime/src/integration_test.rs:184] 🏁 === AnimaWeave 端到端测试完成 ===
